" vim:ts=4:sw=4:ft=vim:expandtab:set fdm=marker:
" 
" å·¥ä½œç”¨çš„vimrc
"
" Maintainer:    ç™½äº®
" Last Change:  2014å¹´03æœˆ24æ—¥

""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"                       å¿…é¡»æ”¾åœ¨å¤´éƒ¨çš„é…ç½® {{{1                                "
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"
" è®¾ç½®vim-addon-manageræ’ä»¶  {{{1
"
let addon_list=[]
set runtimepath+=~/vim-addons/vim-addon-manager
set runtimepath+=~/vim-addons/mysnip
let addon_list += ["Colour_Sampler_Pack"]
let addon_list += [ "ScrollColors" ]
let addon_list += [ "FuzzyFinder"]
let addon_list += [ "The_NERD_Commenter"]
let addon_list += [ "surround"]
let addon_list += [ "Markdown"]
let addon_list += [ "fugitive"] 
let addon_list += [ "EasyMotion"]
let addon_list += [ "git-vim"]
let addon_list += [ "ShowMarks"]
let addon_list += [ "YankRing"]
let addon_list += [ "taglist"]
let addon_list += [ "TaskList"]
let addon_list += [ "sessionman"]
let addon_list += [ "L9"]
let addon_list += [ "bash-support"]
"let addon_list += [ "Tagbar"]
"let addon_list += [ "VimIM"]
let addon_list += [ "UltiSnips"]
let addon_list += [ "fcitx"]

" å’Œbashç›¸å…³
let addon_list += [ "bash-support"]

" å’Œpythonç›¸å…³
let addon_list += [ "vim-flake8"]
let addon_list += [ "pytest"]
let addon_list += [ "Gundo"]
let addon_list += [ "python_pydoc"]
let addon_list += [ "indentpython%3461"]
"éœ€è¦å®‰è£…,ä½†æ˜¯ä¸éœ€è¦æ¿€æ´»,ä½¿ç”¨ä»–çš„å­—å…¸æ”¯æŒè¡¥å…¨
"let addon_list += [ "Pydiction"]

" å’Œhaskellç›¸å…³
"let addon_list += [ "neco-ghc"]
"let addon_list += [ "neocomplcache"]
"let addon_list += [ "syntaxhaskell"]
"
"let addon_list += [ "The_NERD_tree"]
"let addon_list += [ "SuperTab_continued."]

call vam#ActivateAddons(addon_list, {'auto_install' : 0})

" }}}1
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"                                                                              "
"                      ä¸ºå¿«é€Ÿç¼–è¾‘vimrcè®¾ç½®éƒ¨åˆ†     {{{1                        "
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"è®¾ç½®é»˜è®¤çš„mapleaderä¸ºé€—å·"{{{
let mapleader=","
"è®¾ç½®å¿«é€Ÿç¼–è¾‘.vimrcæ–‡ä»¶ ,e ç¼–è¾‘.vimrc
map <silent> <leader>e :call SwitchToBuf("~/.vimrc")<cr>
"map <silent> <leader>e :e ~/.vimrc<cr>                                                                        
" è®¾ç½® ,s å¿«é€Ÿé‡æ–°åº”ç”¨ .vimrc
map <silent> <leader>s :source ~/.vimrc<cr>
"ä¿å­˜.vimrcæ–‡ä»¶åä¼šè‡ªåŠ¨è°ƒç”¨æ–°çš„.vimrc
autocmd! bufwritepost .vimrc source ~/.vimrc"}}}
" }}}1
" å¿«é€Ÿç¼–è¾‘é”™é¢˜é›†æ–‡ä»¶
map <silent> <leader>l :call SwitchToBuf("~/Nutstore/err/3b/error3b.tex")<cr>
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"                                                                              "
"                         vimé€šç”¨è®¾ç½®éƒ¨åˆ†     {{{1                             ""{{{
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"
" è®¾ç½®ä¸­æ–‡ç¼–ç   {{{2 
"
set fileencodings=ucs-bom,utf-8,cp936
set fileencoding=utf-8
set encoding=utf-8
set ambiwidth=double
" }}}2

"å…¶ä»–è®¾ç½® {{{2
set nocompatible "è®¾ç½®ä¸å…¼å®¹æ¨¡å¼
filetype plugin indent on "è‡ªåŠ¨æ£€æµ‹æ–‡ä»¶ç±»å‹ã€æ’ä»¶ã€ç¼©è¿›
syntax enable "æ‰“å¼€è¯­æ³•é«˜äº®
if has("gui_running")
    " åœ¨Gvimç¯å¢ƒé‡Œ
    set guioptions-=T  "å…³é—­å·¥å…·æ 
    set guioptions-=m  "å…³é—­èœå•
    colorscheme candycode "è½½å…¥è‰²å½©æ–¹æ¡ˆ å¿…é¡»å®‰è£… Color_Sampler_Packæ’ä»¶
    set cursorline    "åæ˜¾å…‰æ ‡å½“å‰è¡Œé¢œè‰²
else
    " åœ¨ç»ˆç«¯ç¯å¢ƒé‡Œ
    set background=dark
    colorscheme ron "è½½å…¥è‰²å½©æ–¹æ¡ˆ  å¿…é¡»å®‰è£… Color_Sampler_Packæ’ä»¶

endif
"
" è®¾ç½®çª—å£æœ€å¤§åŒ–
"autocmd GUIEnter * winsize 167 41     "14å¯¸å±å¹•
autocmd GUIEnter * winsize 192 66      "1920*1200
autocmd GUIEnter * winpos 0 0 

set mouse=a "è®¾ç½®é¼ æ ‡æ”¯æŒ
"set nobackup "å–æ¶ˆè‡ªåŠ¨å¤‡ä»½
"setlocal noswapfile "ä¸è¦ç”Ÿæˆswapæ–‡ä»¶
set dir=/tmp    "æŒ‡å®šswapæ–‡ä»¶çš„ä½ç½®
set bufhidden=hide "å½“bufferè¢«ä¸¢å¼ƒæ—¶éšè—
set autoread "è®¾ç½®è‡ªåŠ¨è¯»å–æ–‡ä»¶å½“å¤–éƒ¨æ–‡ä»¶è¢«ä¿®æ”¹æ—¶
set showcmd "è®¾ç½®æ˜¾ç¤ºæœªå®Œæˆçš„å‘½ä»¤
set scrolloff=7  "å…‰æ ‡ä¸Šä¸‹ä¸¤ä¾§æœ€å°‘ä¿ç•™çš„å±å¹•è¡Œæ•°
set wildmenu  "å‘½ä»¤è¡Œè¡¥å…¨
set number		"è®¾ç½®æ˜¾ç¤ºè¡Œå·
set cmdheight=2  "è®¾ç½®å‘½ä»¤è¡Œé«˜åº¦ä¸º2è¡Œ
set guifont=Courier\ 10\ Pitch\ 12
"set guifont=Bitstream\ Vera\ Sans\ Mono\ 12
set autoindent "è®¾ç½®è‡ªåŠ¨ç¼©è¿›
set backspace=indent,eol,start "è®¾ç½® Backspace çš„å›é€€åˆ é™¤æ—¶é‡åˆ°è¾¹ç•Œçš„æ•ˆæœ
set whichwrap=b,s,<,>,[,] "è®¾ç½®å·¦å³æ–¹å‘é”®åˆ°è¾¹ç•Œçš„æ•ˆæœ
set expandtab "ä½¿ç”¨ç©ºæ ¼ä»£æ›¿ tab
set tabstop=4 "1ä¸ªTabæ¢æˆ4ä¸ªç©ºæ ¼
set shiftwidth=4 "è‡ªåŠ¨ç¼©è¿›æ—¶çš„å®½åº¦4ä¸ªç©ºæ ¼
set smarttab "èƒ½å¤Ÿä¸€æ¬¡æ€§åˆ é™¤æ¨¡æ‹Ÿçš„tab
set completeopt=menu,longest "è®¾ç½®è¡¥å…¨çŠ¶æ€,ctrl+Lè¿›è¡Œæœ€é•¿è¡¥å…¨
set isfname-== isfname-=, "åœ¨,=åé¢å¯ä»¥è¡¥å…¨æ–‡ä»¶å
"set virtualedit=all "è®¾ç½®è™šæ‹Ÿç¼–è¾‘åŒº
set modeline "æ”¯æŒæ¨¡å¼è¡Œ
"set viminfo='500,:500,<500,s10,h,f1 "è®¾ç½®vimè‡ªåŠ¨ä¿å­˜çš„ä¿¡æ¯
set viminfo='500,:500,<500,s10,h "è®¾ç½®vimè‡ªåŠ¨ä¿å­˜çš„ä¿¡æ¯
"set foldcolumn=2 "è®¾ç½®æŠ˜å æ å®½åº¦2 

"
"è®¾ç½®é«˜äº®æœç´¢ã€è¾“å…¥å­—ç¬¦ä¸²å°±æ˜¾ç¤ºåŒ¹é…ç‚¹  {{{2
"
set hlsearch	"æœç´¢å‡ºä¹‹åé«˜äº®å…³é”®è¯
set incsearch	"æœç´¢æ—¶é«˜äº®å…³é”®è¯
set ignorecase   "æœç´¢æ—¶å¿½ç•¥å¤§å°å†™
nmap <silent> <leader><cr> :noh<cr>  ", å¿«é€Ÿæ¸…é™¤é«˜äº®æœç´¢
" }}}2

" å…³äºæ ‡ç­¾é¡µçš„æ ‡é¢˜ä¿®æ”¹ "{{{
" ä½¿ç”¨äº†è‡ªå®šä¹‰å‡½æ•°  GuiTabLabel()
set showtabline=2 " always show tabs in gvim, but not vim
set guitablabel=%{GuiTabLabel()}"}}}

"
" è®¾ç½®çª—å£ctrl+hjklå¿«é€Ÿåˆ‡æ¢ {{{2
"
nnoremap <c-h> <c-w>h
nnoremap <c-j> <c-w>j
nnoremap <c-k> <c-w>k
nnoremap <c-l> <c-w>l
" }}}2
" è®¾ç½®çª—å£ctrl+shift+ä¸Šä¸‹å·¦å³é”®æ”¹å˜çª—å£å¤§å°"{{{
nnoremap <C-S-Left> 5<c-w>< 
nnoremap <C-S-Down> 5<c-w>-
nnoremap <C-S-Up> 5<c-w>+
nnoremap <C-S-Right> 5<c-w>>"}}}
" è®¾ç½®æ ‡ç­¾alt+ctrl+å·¦å³é”®ç§»åŠ¨æ ‡ç­¾"{{{
nnoremap <silent> <M-C-left> :if tabpagenr() == 1\|exe "tabm ".tabpagenr("$")\|el\|exe "tabm ".(tabpagenr()-2)\|en<CR>
nnoremap <silent> <M-C-right> :if tabpagenr() == tabpagenr("$")\|tabm 0\|el\|exe "tabm ".tabpagenr()\|en<CR>"}}}
" è®¾ç½®alt+hlé”®åˆ‡æ¢æ ‡ç­¾"{{{
nnoremap <silent> <M-h> gT
nnoremap <silent> <M-l> gt
"}}}
" è®¾ç½®ctrl+å·¦å³é”®åˆ‡æ¢ç¼“å†²åŒº"{{{
nnoremap <silent> <C-left> :bNext<cr>
nnoremap <silent> <C-right> :bnext<cr>
"}}}
" è®¾ç½®alt+]æ¥åœ¨æ–°çš„æ ‡ç­¾é¡µæ˜¾ç¤ºtag"{{{
nnoremap <M-]> <c-w><c-]><c-w>T
"}}}
" è®¾ç½®ctrl+ä¸Šä¸‹é”®æ˜¾ç¤ºèœå•"{{{
map <silent> <C-Down> :if &guioptions =~#'T'<Bar> 
            \set guioptions-=T <Bar>
            \set guioptions-=m <bar>
        \endif<CR>

map <silent> <C-Up> :if &guioptions !~#'T'<Bar> 
            \set guioptions+=T <Bar>
            \set guioptions+=m <Bar>
        \endif<CR>
"}}}
"
" è®¾ç½®ctrl+c ctrl+v æ‹·è´ç²˜è´´  {{{2 
"
"source $VIMRUNTIME/mswin.vim
"behave mswin
" }}}2
"
" è®¾ç½®ç¼©å†™
"
" è®¾ç½®thä¸ºæ–°å¼€é¡µé¢å¸®åŠ©
cnoreabbrev th tab help
cnoreabbrev me mksession! ~/.vim/etool.vim
cnoreabbrev se source ~/.vim/etool.vim

"
" è®¾ç½®sudo ä¿å­˜æ–‡ä»¶
" :w !sudo tee %
"
command! -nargs=? Sudow :w !sudo tee %

"
"å°†å½“å‰æŸ¥æ‰¾çš„æ‰€æœ‰åŒ¹é…è¡Œå¯¼å…¥åˆ°å¦ä¸€çª—å£
"
nnoremap <silent>gp :let @p=@_<CR>:g/<C-R>//y P<CR>:new<CR>pdkyG
" }}}1
" "}}}
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"                                                                              "
"                        é€šç”¨æ’ä»¶è®¾ç½®éƒ¨åˆ†   {{{1                               "
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"
"NERD Tree é…ç½®"{{{
"
if count(addon_list,{'name':'The_NERD_tree'})
    let NERDChristmasTree=1 " æ–‡ä»¶ç›®å½•ä½¿ç”¨æ ‘çŠ¶ç»“æ„æ˜¾ç¤º
    let NERDTreeAutoCenter=1 " å½“å…‰æ ‡ç§»åŠ¨è¶…è¿‡ä¸€å®šè·ç¦»æ—¶è‡ªåŠ¨å°†ç„¦ç‚¹è°ƒæ•´åˆ°å±ä¸­å¿ƒ
    let NERDTreeBookmarksFile=$HOME.'/NerdBookmarks.txt' " æŒ‡å®šä¹¦ç­¾æ–‡ä»¶ä½ç½®
    let NERDTreeMouseMode=2 " é¼ æ ‡å•å‡»æ‰“å¼€ç›®å½•,åŒå‡»æ‰“å¼€æ–‡ä»¶
    let NERDTreeShowBookmarks=1 " æ˜¾ç¤ºä¹¦ç­¾åˆ—è¡¨                                      
    let NERDTreeShowFiles=1 " æ˜¾ç¤ºæ–‡ä»¶
    let NERDTreeShowHidden=1 " æ˜¾ç¤ºéšè—æ–‡ä»¶
    let NERDTreeShowLineNumbers=1 " æ˜¾ç¤ºè¡Œå·
    let NERDTreeWinPos='left' "NERD çª—å£ä½ç½®åœ¨å·¦ä¾§
    let NERDTreeWinSize=60 "NERD çª—å£å®½åº¦
    nnoremap <silent> <leader>f :NERDTreeToggle<CR> | "è®¾ç½®NERDTreeçš„è°ƒç”¨å¿«æ·é”®<leader>f
    nnoremap <silent> <leader>nf :NERDTreeFind<CR>  | "è®¾ç½®NERDTreeæ˜¾ç¤ºå½“å‰æ–‡ä»¶ä½ç½®<leader>nf
endif
"}}}
"
"vimimé…åˆ¶"{{{
"
if count(addon_list,{'name':'vimim'})
"    let g:vimim_onekey_hit_and_run = 1 
    let g:vimim_chinese_input_mode='static' 
    "let g:vimim_cloud='baidu,sogou,qq,google'  
    let g:vimim_cloud='sogou,qq'  
endif
"}}}
"
"markdowné…ç½®
"
nmap md :!/usr/local/bin/markdown_py % > %.html && firefox %.html & <CR><CR>
"nmap mr :w <cr><cr>:!/usr/local/bin/markdown_py % > %.html && xdotool search --name Pentadactyl key r<CR><CR>
nmap mr :w<cr>:!/usr/local/bin/markdown_py % > %.html && wmctrl -a "Pentadactyl" && xdotool key --delay 500  r && wmctrl -a "Gvim"<CR><cr>
nmap me :!/usr/local/bin/markdown_py % > %.html && gvim %.html & <CR><CR>

"
" UltiSnipsé…ç½®"{{{
"
    "è®¾ç½®æ’ä»¶çš„æœ¬åœ°ç›®å½•
    "let g:UltiSnipsSnippetsDir="~/vim-addons/UltiSnips/UltiSnips/"
    "è®¾ç½®ç¼–è¾‘æ’ä»¶ç‰‡æ®µæ–‡æœ¬é‡‡ç”¨ä¸Šä¸‹åˆ†å‰²çš„æ–¹å¼
    let g:UltiSnipsEditSplit ="horizontal"
    "å¢åŠ æœ¬åœ°ç‰‡æ®µè·¯å¾„
    "let g:UltiSnipsSnippetDirectories=["UltiSnips"]
    " Set ultisnips triggers
     let g:UltiSnipsExpandTrigger="<tab>"                                            
     let g:UltiSnipsJumpForwardTrigger="<tab>"                                       
     let g:UltiSnipsJumpBackwardTrigger="<s-tab>"     
"}}}

"
" showmarks æ’ä»¶è®¾ç½®{{{
"
if count(addon_list,{'name':'ShowMarks'})
    let showmarks_enable = 1 " ShowMarksä¼´éšVimä¸€åŒå¯åŠ¨
    "è®¾ç½®a-zA-Zä¸ºæ˜¾ç¤ºæ ‡è®°
    let showmarks_include = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ" 
    let showmarks_ignore_type = "hqm" " å¿½ç•¥help, quickfixå’Œä¸å¯ç¼–è¾‘ç¼“å†²åŒºçš„æ ‡è®°
    "let showmarks_hlline_lower = 1 "é«˜äº®æ˜¾ç¤ºå°å†™æ ‡è®°è¡Œ
    "let showmarks_hlline_upper = 1 "é«˜äº®æ˜¾ç¤ºå¤§å†™æ ‡è®°è¡Œ

    " è®¾ç½®æ ‡è®°è¡Œçš„é¢œè‰²
    highlight ShowMarksHLl  guibg=darkgreen
    highlight ShowMarksHLu  guibg=darkblue
endif
"}}}
"
" marksbrowser æ’ä»¶è®¾ç½®"{{{
"
if count(addon_list,{'name':'Marks_Browser'})
    nmap <silent> <leader>mk :MarksBrowser<cr> "å®šä¹‰,mkæ¿€æ´»marksbrowseræ’ä»¶
endif"}}}
"
" yankring æ’ä»¶è®¾ç½®"{{{
"
if count(addon_list,{'name':'YankRing'})
    nnoremap <silent> <F11> :YRShow<CR> â€œ è®¾ç½®æ­£å¸¸æ¨¡å¼å¿«æ·é”®F11æ˜¾ç¤ºyankringçª—å£
    inoremap <silent> <F11> <ESC>:YRShow<cr> â€œ è®¾ç½®æ’å…¥æ¨¡å¼å¿«æ·é”®F11æ˜¾ç¤ºyankringçª—å£
endif
"}}}
"
" supertab æ’ä»¶è®¾ç½®"{{{
"
"if count(addon_list,'SuperTab_continued.')
    let g:SuperTabDefaultCompletionType="context"
    let g:snips_author1='ç™½äº®'
    let g:snips_trigger_key='<f2>'
"endif
"}}}
"
" BufExplorer æ’ä»¶è®¾ç½®"{{{
"
"let g:bufExplorerDefaultHelp=0       " æ˜¾ç¤ºé»˜è®¤å¸®åŠ©ä¿¡æ¯
"let g:bufExplorerDetailedHelp=0      " æ˜¾ç¤ºè¯¦ç»†å¸®åŠ©
"let g:bufExplorerFindActive=1        " ç§»åŠ¨åˆ°æ¿€æ´»çª—å£
"let g:bufExplorerShowRelativePath=1  " Show relative paths.
"let g:bufExplorerSortBy='mru'        " Sort by most recently used.
"let g:bufExplorerSplitRight=0        " Split left.
"let g:bufExplorerUseCurrentWindow=1  " Open in new window.
"autocmd BufWinEnter /[Buf/ List/] setl nonumber
"
"}}}
"
" NERD_Commentè®¾ç½®"{{{
" 
    "imap <F3>  <plug>NERDCommenterInInsert
    "}}}
"
" mruè®¾ç½®"{{{
"
if count(addon_list,'mru')
    let MRU_Exclude_Files = '^/tmp/.*\|^/var/tmp/.*\|\.tmp$\|\.cnx$'  " ç¦æ­¢ä¿å­˜è¯¥ç›®å½•æ–‡ä»¶
    "let MRU_Include_Files = '\.c$\|\.h$'             " åªä¿å­˜æŒ‡å®šç±»å‹æ–‡ä»¶
    let MRU_Include_Files = '' 
    let MRU_Add_Menu = 0 "ç¦æ­¢æ›´æ”¹èœå•
    nnoremap <silent> <leader>nm :MRU<CR>  ",nmå¿«æ·é”®æ‰“å¼€mruçª—å£ 
    nnoremap <leader>nM :MRU  | ",nMå¿«æ·é”®å‡ºç°å‘½ä»¤æç¤ºè¡Œç­‰å¾…è¾“å…¥æ–‡ä»¶å 
endif
"}}}
"
" taglist"{{{
"
if count(addon_list,'taglist')
    nnoremap <silent> <F3> :TlistToggle<cr>
    "nnoremap <silent> <C-F3> :TlistOpen<cr>
    let Tlist_Highlight_Tag_On_BufEnter=0
    let Tlist_Close_On_Select=1    "é€‰æ‹©åè‡ªåŠ¨å…³é—­
    let Tlist_Process_File_Always = 1
    let Tlist_Exit_OnlyWindow=1    "åªå‰©taglistçª—å£æ—¶å…³é—­vim
    let Tlist_File_Fold_Auto_Close = 1
    let Tlist_GainFocus_On_ToggleOpen = 1   "TlistToggleæ‰“å¼€taglistæ—¶ï¼Œè¾“å…¥ç„¦ç‚¹åœ¨taglistä¸­
	let Tlist_WinWidth = 40
endif
"}}}
"
" Tagbar"{{{
"
if count(addon_list,'Tagbar')
    nmap <silent> <F4> :TagbarToggle<CR>
    "let g:tagbar_width = 30
    let g:tagbar_left = 1
    let g:tagbar_autofocus = 1
endif
"}}}
"
" FuzzyFinder é…ç½®"{{{
"
"let g:fuf_modesDisable = [ 'mrufile', 'mrucmd', ]
let g:fuf_modesDisable = [ 'mrucmd' ]
let g:fuf_mrufile_maxItem = 100
let g:fuf_mrucmd_maxItem = 100
let g:fuf_reuseWindow = 1 "æ¯æ¬¡éƒ½é‡æ–°æ‰“å¼€çª—å£ 
let g:fuf_keyNextPattern = '<C-z>'
" Fuf {{{
nnoremap <silent> fb     :FufBuffer<CR>
nnoremap <silent> ff     :FufFileWithCurrentBufferDir<CR>
nnoremap <silent> fF     :FufFileWithFullCwd<CR>
nnoremap <silent> f<C-f> :FufFile<CR>
nnoremap <silent> fo     :FufCoverageFileChange<CR>
nnoremap <silent> f<C-o> :FufCoverageFileRegister<CR>
nnoremap <silent> fd     :FufDirWithCurrentBufferDir<CR>
nnoremap <silent> fD     :FufDirWithFullCwd<CR>
nnoremap <silent> f<C-d> :FufDir<CR>
nnoremap <silent> fn     :FufMruFile<CR>
nnoremap <silent> fN     :FufMruFileInCwd<CR>
nnoremap <silent> fm     :FufMruCmd<CR>
nnoremap <silent> fu     :FufBookmarkFile<CR>
nnoremap <silent> f<C-u> :FufBookmarkFileAdd<CR>
vnoremap <silent> f<C-u> :FufBookmarkFileAddAsSelectedText<CR>
nnoremap <silent> fi     :FufBookmarkDir<CR>
nnoremap <silent> f<C-i> :FufBookmarkDirAdd<CR>
nnoremap <silent> ft     :FufTag<CR>
nnoremap <silent> f<C-]> :FufTagWithCursorWord!<CR>
nnoremap <silent> f,     :FufBufferTag<CR>
nnoremap <silent> f}     :FufBufferTagWithCursorWord!<CR>
vnoremap <silent> f}     :FufBufferTagWithSelectedText!<CR>
nnoremap <silent> f.     :FufBufferTagAll<CR>
nnoremap <silent> f]     :FufBufferTagAllWithCursorWord!<CR>
vnoremap <silent> f]     :FufBufferTagAllWithSelectedText!<CR>
nnoremap <silent> fg     :FufTaggedFile<CR>
nnoremap <silent> fj     :FufJumpList<CR>
nnoremap <silent> fc     :FufChangeList<CR>
nnoremap <silent> fq     :FufQuickfix<CR>
nnoremap <silent> fl     :FufLine<CR>
nnoremap <silent> fh     :FufHelp<CR>
nnoremap <silent> fe     :FufEditDataFile<CR>
nnoremap <silent> fr     :FufRenewCache<CR>
"}}}
"
" F1å’Œshift+F1è°ƒç”¨FuzzyFinderå‘½ä»¤è¡Œèœå•""{{{
"
function! GetAllCommands()"{{{
  redir => commands
  silent command
  redir END
  return map((split(commands, "\n")[3:]),
      \      '":" . matchstr(v:val, ''^....\zs\S*'')')
endfunction"}}}

" è‡ªå®šä¹‰å‘½ä»¤è¡Œ
let g:fuf_com_list=[]"{{{
    """""""""""""è¶…è¿‡æœ¬è¡ŒåŒå¼•å·å®½åº¦çš„å†…å®¹ä¼šè¢«éšè—"""""""""""""""""""""""""""""""""""""""""""""""
    let g:fuf_com_list += [':exe ''"|    fb       --file search in all buffers             |        --''|:FufBuffer']
    let g:fuf_com_list += [':exe ''"|    ff       --file search in <current buffer dir>    |        --''|:FufFileWithCurrentBufferDir']
    let g:fuf_com_list += [':exe ''"|    fF       --file search by [full path]             |        --''|:FufFileWithFullCwd']
    let g:fuf_com_list += [':exe ''"|    f<C-f>   --file search by ç›¸å¯¹è·¯å¾„                |        --''|:FufFile']
    let g:fuf_com_list += [':exe ''"|    fo       --coverage file                          |        --''|:FufCoverageFileChange']
    let g:fuf_com_list += [':exe ''"|    f<C-o>   --add new coverage type                  |        --''|:FufCoverageFileRegister']
    let g:fuf_com_list += [':exe ''"|    fd       --<current buffer dir> cd                |        --''|:FufDirWithCurrentBufferDir']
    let g:fuf_com_list += [':exe ''"|    fD       --cd [full path]                         |        --''|:FufDirWithFullCwd']
    let g:fuf_com_list += [':exe ''"|    f<C-d>   --cd ç›¸å¯¹è·¯å¾„                            |        --''|:FufDir']
    let g:fuf_com_list += [':exe ''"|    fn       --file mru open files                    |        --''|:FufMruFile']
    let g:fuf_com_list += [':exe ''"|    fN       --file mru by current dir                |        --''|:FufMruFileInCwd']
    let g:fuf_com_list += [':exe ''"|    fm       --vim command mru                        |        --''|:FufMruCmd']
    let g:fuf_com_list += [':exe ''"|    fu       --bookmarks file                         |        --''|:FufBookmarkFile']
    let g:fuf_com_list += [':exe ''"|    f<C-u>   --add bookmarks file                     |        --''|:FufBookmarkFileAdd']
    let g:fuf_com_list += [':exe ''"|    f<C-u>   --select text  bookmarks file            |        --''|:FufBookmarkFileAddAsSelectedText"']
    let g:fuf_com_list += [':exe ''"|    fi       --bookmarks dir                          |        --''|:FufBookmarkDir']
    let g:fuf_com_list += [':exe ''"|    f<C-i>   --add bookmarks dir                      |        --''|:FufBookmarkDirAdd']
    let g:fuf_com_list += [':exe ''"|    ft       --tag search by tags file                |        --''|:FufTag']
    let g:fuf_com_list += [':exe ''"|    f<C-]>   --cursor word tag by tags file           |        --''|:FufTagWithCursorWord!']
    let g:fuf_com_list += [':exe ''"|    f,       --current buffer tag                     |        --''|:FufBufferTag']
    let g:fuf_com_list += [':exe ''"|    f}       --current buffer selected text tag       |        --''|:FufBufferTagWithSelectedText!']
    let g:fuf_com_list += [':exe ''"|    f}       --current buffer cursor word tag         |        --''|:FufBufferTagWithCursorWord!']
    let g:fuf_com_list += [':exe ''"|    f.       --all buffer tag                         |        --''|:FufBufferTagAll']
    let g:fuf_com_list += [':exe ''"|    f]       --all buffer selected text tag           |        --''|:FufBufferTagAllWithSelectedText!"']
    let g:fuf_com_list += [':exe ''"|    f]       --all buffer cursor word tag             |        --''|:FufBufferTagAllWithCursorWord!']
    let g:fuf_com_list += [':exe ''"|    fg       --file search in tags                    |        --''|:FufTaggedFile']
    let g:fuf_com_list += [':exe ''"|    fj       --jump list                              |        --''|:FufJumpList']
    let g:fuf_com_list += [':exe ''"|    fc       --change list                            |        --''|:FufChangeList']
    let g:fuf_com_list += [':exe ''"|    fq       --quickfix                               |        --''|:FufQuickfix']
    let g:fuf_com_list += [':exe ''"|    fl       --full line in current buffer            |        --''|:FufLine']
    let g:fuf_com_list += [':exe ''"|    fh       --help search                            |        --''|:FufHelp']
    let g:fuf_com_list += [':exe ''"|    fe       --fuf data edit                          |        --''|:FufEditDataFile']
    let g:fuf_com_list += [':exe ''"|    fr       --fuf renew cache                        |        --''|:FufRenewCache']
    "}}}                                                                                                                       
"                                                                                                                              
" æœ¬åœ°vimrcçš„å¿«æ·åˆ—è¡¨                                                                                                          
"                                                                                                                              
let s:comm_dict={                                                                                                              
            \1:'call fuf#givencmd#launch("", 0, "é€‰æ‹©å‘½ä»¤>", GetAllCommands())',                                               
            \2:'call fuf#givencmd#launch("", 0, "é€‰æ‹©å‘½ä»¤>", g:fuf_com_list)',
            \}
fun! RLC(keynum)
    " è°ƒç”¨å‘½ä»¤
    execute s:comm_dict[a:keynum]
endf
"
" ç‰‡æ®µçš„è¾“å…¥æ³¨è®°
" fln æ™®é€šå¿«æ·é”®åºåˆ— fle å¸¦åŠŸèƒ½é”®çš„åºåˆ— flc å‡½æ•°è°ƒç”¨RLC
"
let g:fuf_local_list=[]
    """""""""""""è¶…è¿‡æœ¬è¡ŒåŒå¼•å·å®½åº¦çš„å†…å®¹ä¼šè¢«éšè—"""""""""""""""""""""""""""""""""""""""""
    let g:fuf_local_list += [':exe ''"|   ,e         --å¿«é€Ÿç¼–è¾‘vimrc                            kuaisubianjivimrc --''|:norm ,e']
    let g:fuf_local_list += [':exe ''"|   ,s         --å¿«é€Ÿåº”ç”¨vimrc                            kuaisuyingyongvimrc --''|:norm     ,s']
    let g:fuf_local_list += [':exe ''"|   ,<å›è½¦>    --æ¸…é™¤é«˜äº®æœç´¢ç»“æœ                         qingchugaoliangsousuojieguo clear high light search --''|:exe "norm ,\<CR>" ']
    let g:fuf_local_list += [':exe ''"|   ,be   bufex--å½“å‰çª—å£é€‰æ‹©ç¼“å†²åŒºåˆ—è¡¨                   dangqianchuangkouxuanzehuanchongquliebiao select list buffer open  --''|:norm ,be ']
    let g:fuf_local_list += [':exe ''"|   ,bs   bufex--ä¸Šæ–¹å¼€æ–°çª—å£é€‰æ‹©ç¼“å†²åŒº                   shangfangkaixinchuangkouxuanzehuanchongqu up split select list buffer open  --''|:norm ,bs ']
    let g:fuf_local_list += [':exe ''"|   ,bv   bufex--å·¦ä¾§å¼€æ–°çª—å£é€‰æ‹©ç¼“å†²åŒº                   zuocekaixinchuangkouxuanzehuanchongqu left vsplit select list buffer open  --''|:norm ,bv ']
    let g:fuf_local_list += [':exe ''"|   alt+]      --åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€å¸®åŠ©                       new tab help --''|:exe "norm \<M-]>" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+h     --å…‰æ ‡è·³åˆ°å·¦ä¾§çª—å£                         tdzcck jump left window --''|:exe "norm \<C-H>" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+l     --å…‰æ ‡è·³åˆ°å³ä¾§çª—å£                         tdycck jump right window --''|:exe "norm \<C-L>" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+k     --å…‰æ ‡è·³åˆ°ä¸Šæ–¹çª—å£                         tdsfco jump up window --''|:exe "norm \<C-K>" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+j     --å…‰æ ‡è·³åˆ°ä¸‹æ–¹çª—å£                         tdxfck jump down window --''|:exe "norm \<C-J>" ']
    let g:fuf_local_list += [':exe ''"|   shift+F1   --ç­›é€‰æ‰€æœ‰è‡ªå®šä¹‰çš„å‘½ä»¤                     sxzdyml command --''|:exe ":cal RLC(1)" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+F1    --ç­›é€‰fufæ’ä»¶å‘½ä»¤                          sxcjml plugin command --''|:exe ":cal RLC(2)" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+shift+left    --å‡å°‘å½“å‰çª—å£å®½åº¦                 jianshaodangqianchuangkoukuandu now window width  --''|:exe "norm \<C-S-Left>" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+shift+right   --å¢åŠ å½“å‰çª—å£å®½åº¦                 zengjiadangqianchuangkoukuandu now window width  --''|:exe "norm \<C-S-right>" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+shift+up      --å¢åŠ å½“å‰çª—å£é«˜åº¦                 zengjiadangqianchuangkou now window width  --''|:exe "norm \<C-S-up>" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+shift+down    --å‡å°‘å½“å‰çª—å£é«˜åº¦                 jianshaodangqianchuangkoukuandu now window width  --''|:exe "norm \<C-S-down>" ']
    let g:fuf_local_list += [':exe ''"|   Alt+ctrl+left      --å‘å·¦ç§»åŠ¨å½“å‰æ ‡ç­¾é¡µ               xiangzuoyidongdangqianbiaoqianye left tab move     --''|:exe "norm \<M-C-Left>" ']
    let g:fuf_local_list += [':exe ''"|   Alt+ctrl+right     --å‘å³ç§»åŠ¨å½“å‰æ ‡ç­¾é¡µ               xiangyouyidongdangqianbiaoqianye right tab move     --''|:exe "norm \<M-C-Right>" ']
    let g:fuf_local_list += [':exe ''"|   Alt+l              --æ¿€æ´»å³ä¾§æ ‡ç­¾é¡µ                   jihuoyoucebiaoqianye jump right tab   --''|:norm     gt ']
    let g:fuf_local_list += [':exe ''"|   Alt+h              --æ¿€æ´»å·¦ä¾§æ ‡ç­¾é¡µ                   jihuozuocebiaoqianye jump left tab   --''|:norm     gT ']
    let g:fuf_local_list += [':exe ''"|   ctrl+left          --åˆ‡æ¢åˆ°å‰ä¸€ä¸ªç¼“å†²åŒº               qiehuandaoqianyigehuanchongqu pre buffer     --''|:exe "norm \<C-left>" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+right         --åˆ‡æ¢åˆ°åä¸€ä¸ªç¼“å†²åŒº               qiehuandaohouyigehuanchongqu next buffer     --''|:exe "norm \<C-right>" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+down          --å–æ¶ˆvimèœå•                      quxiaocaidan clear off hide menu     --''|:exe "norm \<c-down>" ']
    let g:fuf_local_list += [':exe ''"|   ctrl+up            --æ˜¾ç¤ºvimèœå•                      xianshicaidan show on menu     --''|:exe "norm \<c-up>" ']
    let g:fuf_local_list += [':exe ''"|   gp        --ä¿å­˜ç¬¦åˆå½“å‰æœç´¢æ¡ä»¶çš„å†…å®¹                baocunfuhedangqiansousuotiaojiandeneirong search save file --''|:norm     gp ']
    let g:fuf_local_list += [':exe ''"|   ,f   NerdT--å¼€å…³nerdtreeæ’ä»¶çª—å£                      kaiguannerdtreechajianchuangkou show windows hide on switch off --''|:norm     ,f ']
    let g:fuf_local_list += [':exe ''"|   ,nf  NerdT--ç›®å½•æ ‘æ˜¾ç¤ºå½“å‰ç¼–è¾‘æ–‡ä»¶ä½ç½®                mulushuxianshidangqianbianjiwenjianweizhi show nerdtree --''|:norm     ,nf']
    let g:fuf_local_list += [':exe ''"|   F11  yankR--å¼€å…³yankringæ’ä»¶çª—å£                      kaiguanyankringchajianchuangkou show windows on hide switch off --''|:YRShow']
    let g:fuf_local_list += [':exe ''"|   ,nm    MRU--æ‰“å¼€mruæ’ä»¶çª—å£                           dakaimruchajianchuangkou open show windows --''|:MRU']
    let g:fuf_local_list += [':exe ''"|   F7    flake8æ£€æŸ¥                                      flakejianchapython --''|:exe "norm \<F7>"']


nnoremap <silent> <F1> :call fuf#givencmd#launch('', 0, 'é€‰æ‹©å‘½ä»¤>', g:fuf_local_list)<CR>
nnoremap <silent> <S-F1> :call fuf#givencmd#launch('', 0, 'é€‰æ‹©å‘½ä»¤>', GetAllCommands())<CR>
nnoremap <silent> <C-F1> :call fuf#givencmd#launch('', 0, 'é€‰æ‹©å‘½ä»¤>', g:fuf_com_list)<CR>
vnoremap <silent> <C-F1> :call fuf#givencmd#launch('', 0, 'é€‰æ‹©å‘½ä»¤>', g:fuf_com_list)<CR>
"}}}
""}}}
"
" winManager æ’ä»¶è®¾ç½®"{{{
"
"let g:persistentBehaviour=0
"let g:winManagerWidth=40
"let g:defaultExplorer=0
"let g:NERDTree_title="[NERDTree]" 
"let g:winManagerWindowLayout='NERDTree|BufExplorer'
"function! NERDTree_Start()
    "exec 'NERDTree'
"endfunction
"function! NERDTree_IsValid()
    "return 1
"endfunction
"nmap wm :if IsWinManagerVisible() <BAR> WMToggle<CR> <BAR> else <BAR> 
            "\ WMToggle<CR>:q<CR> endif <CR><CR>
"nmap wf :if IsWinManagerVisible() <BAR> FirstExplorerWindow<CR> <BAR>  
            "\ else <BAR> WMToggle<CR>:q<CR>FirstExplorerWindow<CR> endif <CR><CR>
"nmap wb :if IsWinManagerVisible() <BAR> BottomExplorerWindow<CR> <BAR>  
            "\ else <BAR> WMToggle<CR>:q<CR>BottomExplorerWindow<CR> endif <CR><CR>  
"}}}

"è®¾ç½®neocomplcache"{{{
     let g:neocomplcache_enable_at_startup=1 "}}}

" 
" è®¾ç½® vim-fugitive"{{{
"set statusline=%<%y\ %F\ %h%m%r%<\ %{Get_diff_mode()}\ 
            "\%{fugitive#statusline()}\ %=%-14.(%l,%c%V%)\ %P
    autocmd BufReadPost fugitive://* set bufhidden=delete 
    map <F10> <Esc>:Gstatus<CR>
    "}}}

"è®¾ç½®Pydiction è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œåªéœ€è¦åè¦†æŒ‰ Ctrl-N å°±è¡Œ"{{{
    "let g:pydiction_location = '~/vim-addons/Pydiction/complete-dict'
    autocmd FileType python set complete+=k~/vim-addons/Pydiction/complete-dict
""}}}

"
"è®¾ç½®pytest.vim"{{{
" Execute the tests
nmap <silent><Leader>tf <Esc>:Pytest file<CR>
nmap <silent><Leader>tc <Esc>:Pytest class<CR>
nmap <silent><F8> <Esc>:Pytest method -s<CR>
" cycle through test errors
nmap <silent><Leader>tn <Esc>:Pytest next<CR>
nmap <silent><Leader>tp <Esc>:Pytest previous<CR>
nmap <silent><Leader>te <Esc>:Pytest error<CR> "}}}

"
"è®¾ç½®Gundoå¿«æ·é”®,g"{{{
    map <leader>g :GundoToggle<cr>

"
" }}}1
"

"
"è®¾ç½®sessionmanå¿«æ·é”® F5 "{{{
    map <F5> :SessionList<cr>

"
" }}}1
"
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"                                                                              "
"                     æ ¹æ®æ–‡ä»¶ç±»å‹çš„ä¸åŒé‡‡ç”¨çš„ç‰¹å®šè®¾ç½®   {{{1                  "
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" å…³äºvimscriptçš„è®¾ç½®"{{{
let g:vimsyn_folding='af'
"}}}
"
"ä¿å­˜ä»£ç æ–‡ä»¶å‰è‡ªåŠ¨ä¿®æ”¹æœ€åä¿®æ”¹æ—¶é—´"{{{
au BufWritePre   *.sh         call TimeStamp('#')
au BufWritePre .vimrc,*.vim   call TimeStamp('"')
au BufWritePre *.c,*.h        call TimeStamp('*')
au BufWritePre *.cpp,*.hpp    call TimeStamp('//')
au BufWritePre *.cxx,*.hxx    call TimeStamp('//')
au BufWritePre *.java         call TimeStamp('//')
au BufWritePre *.rb           call TimeStamp('#')
au BufWritePre *.py           call TimeStamp('#')
au BufWritePre Makefile       call TimeStamp('#')
au BufWritePre *.php
        \call TimeStamp('<?php //', '?>')
"    au BufWritePre *.html,*htm
"        \call TimeStamp('<!--', '-->')"}}}
"
" è®¾ç½®å„ç§è¯­è¨€çš„è‡ªåŠ¨è¡¥å…¨"{{{
autocmd FileType ruby,eruby set omnifunc=rubycomplete#Complete
autocmd FileType python set omnifunc=pythoncomplete#Complete
autocmd FileType javascript set omnifunc=javascriptcomplete#CompleteJS
autocmd FileType html set omnifunc=htmlcomplete#CompleteTags
autocmd FileType css set omnifunc=csscomplete#CompleteCSS
autocmd FileType xml set omnifunc=xmlcomplete#CompleteTags
autocmd FileType java set omnifunc=javacomplete#Complet "}}}
"
" }}}1
"

""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"                                                                              "
"                  æ ¹æ®æ–‡ä»¶ç±»å‹ä¸åŒä¸“ç”¨æ’ä»¶çš„è®¾ç½®éƒ¨åˆ†    {{{1                  "
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

" è®¾ç½®basic"{{{
    autocmd BufRead *.cls   set filetype=vb
    autocmd FileType vb setlocal foldmethod=indent
""}}}
" è®¾ç½®python"{{{
    autocmd FileType python setlocal et sta sw=4 sts=4
    "ä»£ç æŠ˜å å¯ä»¥åªä»¥ç¼©è¿›ä¸ºä¾æ®
    autocmd FileType python setlocal foldmethod=indent
    "é»˜è®¤å±•å¼€æ‰€æœ‰ä»£ç 
    set foldlevel=99
    " Python Unittest çš„ä¸€äº›è®¾ç½®
    " å¯ä»¥è®©æˆ‘ä»¬åœ¨ç¼–å†™ Python ä»£ç åŠ unittest æµ‹è¯•æ—¶ä¸éœ€è¦ç¦»å¼€ vim
    " é”®å…¥ :make æˆ–è€…ç‚¹å‡» gvim å·¥å…·æ¡ä¸Šçš„ make æŒ‰é’®å°±è‡ªåŠ¨æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹
      autocmd FileType python compiler pyunit
      autocmd FileType python setlocal makeprg=python\ ./alltests.py
      autocmd BufNewFile,BufRead test*.py setlocal makeprg=python\ %

    " è‡ªåŠ¨ä½¿ç”¨æ–°æ–‡ä»¶æ¨¡æ¿
      autocmd BufNewFile *.py 0r ~/.vim/skeleton/skeleton_bottom.py  
      autocmd BufNewFile test*.py 0r ~/.vim/skeleton/test.py
      autocmd BufNewFile alltests.py 0r ~/.vim/skeleton/alltests.py
      autocmd BufNewFile *.py 0r ~/.vim/skeleton/skeleton_top.py  
      
    " ä¿å­˜æ—¶è‡ªåŠ¨åˆ é™¤è¡Œå°¾ç©ºæ ¼
        function! RemoveTrailingWhitespace()
            if &ft != "diff"
                let b:curcol = col(".")
                let b:curline = line(".")
                silent! %s/\s\+$//
                silent! %s/\(\s*\n\)\+\%$//
                call cursor(b:curline, b:curcol)
            endif
        endfunction
        autocmd BufWritePre *.py call RemoveTrailingWhitespace() 
        
    " è®¾ç½®makeçš„å¿«æ·é”®,m
      map <C-F8> :make<cr>
      
    " è®¾ç½®runçš„å¿«æ·é”®,r
      map <leader>r :w<cr>:!python %<cr>
      
    " è®¾ç½®é…ç½®å¼€å‘çª—å£é…ç½®å¿«æ·é”®,s
      map <silent> <leader><leader>s :source ~/sen.vim<cr>

      "}}}
      "}}}1
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"                                                                              "
"                     è‡ªå®šä¹‰çš„å‡½æ•°éƒ¨åˆ†     {{{1                                "
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"
"SwitchToBuf()å®ç°å®ƒåœ¨æ‰€æœ‰æ ‡ç­¾é¡µçš„çª—å£ä¸­æŸ¥æ‰¾æŒ‡å®šçš„æ–‡ä»¶åï¼Œå¦‚æœæ‰¾åˆ°è¿™æ ·ä¸€ä¸ªçª—å£ï¼Œ
"å°±è·³åˆ°æ­¤çª—å£ä¸­ï¼›å¦åˆ™ï¼Œå®ƒæ–°å»ºä¸€ä¸ªæ ‡ç­¾é¡µæ¥æ‰“å¼€vimrcæ–‡ä»¶
"ä¸Šé¢è‡ªåŠ¨ç¼–è¾‘.vimrcæ–‡ä»¶ç”¨åˆ°çš„å‡½æ•° 
"
function! SwitchToBuf(filename)"{{{
    let bufwinnr = bufwinnr(a:filename)
    if bufwinnr != -1
    exec bufwinnr . "wincmd w"
        return
    else
        " find in each tab
        tabfirst
        let tab = 1
        while tab <= tabpagenr("$")
            let bufwinnr = bufwinnr(a:filename)
            if bufwinnr != -1
                exec "normal " . tab . "gt"
                exec bufwinnr . "wincmd w"
                return
            endif
            tabnext
            let tab = tab + 1
        endwhile
        " not exist, new tab
        exec "tabnew " . a:filename
    endif
endfunction"}}}
" 
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"
" è‡ªåŠ¨ä¿å­˜æ–‡ä»¶å
"
function! Filename_Save() "{{{
    let pattern =  '^#\s*FileName\s*:'
    let row = search(pattern, 'n')
    if row  != 0 && row <10
        let curstr = getline(row)
        let col = match( curstr , 'FileName\s*:')
        let spacestr = repeat(' ',col-1)
        let buffilename = bufname("%")
        let buffilename = strpart(buffilename,strridx(buffilename,"/")+1)
        "echo strpart(bufname("%"),strridx(bufname("%"),"/"))
        let newline = '#' . spacestr . 'FileName  :  ' . buffilename
        call setline(row, newline)
    endif
endfunction "}}}
" 
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"
"Last changeç”¨åˆ°çš„å‡½æ•°ï¼Œè¿”å›æ—¶é—´ï¼Œèƒ½å¤Ÿè‡ªåŠ¨è°ƒæ•´ä½ç½®
"
function! TimeStamp(...)"{{{
    let sbegin = ''
    let send = ''
    if a:0 >= 1
        let sbegin = a:1.'\s*'
        if a:1 == '*'
            let sbegin = '\' . sbegin
        endif
    endif
    if a:0 >= 2
        let send = ' '.a:2
    endif
    let pattern =  'Last Change:.*'
        \. send
    let pattern = '^\s*' . sbegin . pattern . '\s*$'
    "let now = strftime('%Yå¹´%mæœˆ%dæ—¥ %Hæ—¶%Måˆ†%Sç§’',
    let now = strftime('%Yå¹´%mæœˆ%dæ—¥',localtime())
    let row = search(pattern, 'n')
    if row  != 0
        let curstr = getline(row)
        let col = match( curstr , 'Last')
        let leftcol = match(curstr,sbegin)
        let spacestr = repeat(' ',col - len(a:1)-leftcol)
        let leftspacestr = repeat(' ',leftcol)
        let now = leftspacestr . a:1 . spacestr . 'Last Change:  '
            \. now . send
        call setline(row, now)
    endif
    call Filename_Save()
endfunction"}}}
"
" ä¿®æ”¹æ ‡ç­¾é¡µçš„æ ‡é¢˜
" set up tab labels with tab number, buffer name, number of windows
"
function! GuiTabLabel()"{{{
  let label = ''
  let bufnrlist = tabpagebuflist(v:lnum)
  " Add '+' if one of the buffers in the tab page is modified
  for bufnr in bufnrlist
    if getbufvar(bufnr, "&modified")
      let label = '+'
      break
    endif
  endfor
  " Append the tab number
  let label .= v:lnum.': '
  " Append the buffer name
  let name = bufname(bufnrlist[tabpagewinnr(v:lnum) - 1])
  if name == ''
    " give a name to no-name documents
    if &buftype=='quickfix'
      let name = '[Quickfix List]'
    else
      let name = '[No Name]'
    endif
  else
    " get only the file name
    let name = fnamemodify(name,":t")
  endif
  let label .= name
  " Append the number of windows in the tab page
  let wincount = tabpagewinnr(v:lnum, '$')
  return label . '  [' . wincount . ']'
endfunction"}}}
"
" ä¸ºpythonç¨‹åºè®¾ç½®æ–­ç‚¹ã€å–æ¶ˆæ–­ç‚¹
"
"{{{
python << EOF
import time
import vim
def SetBreakpoint():
    nLine = int( vim.eval( 'line(".")'))
    strLine = vim.current.line
    i = 0
    strWhite = ""
    while strLine[i] == ' ' or strLine[i] == "\t":
        i += 1
        strWhite += strLine[i]
    vim.current.buffer.append(
       "%(space)spdb.set_trace() %(mark)s Breakpoint %(mark)s" %
         {'space':strWhite, 'mark': '#' * 30}, nLine - 1)
    for strLine in vim.current.buffer:
        if strLine == "import pdb":
            break
        else:
            vim.current.buffer.append( 'import pdb', 0)
            vim.command( 'normal j1')
            break
            # vim.command( 'map <C-F7> :py SetBreakpoint()<cr>')

def RemoveBreakpoints():
    nCurrentLine = int( vim.eval( 'line(".")'))
    nLines = []
    nLine = 1
    for strLine in vim.current.buffer:
        if strLine == 'import pdb' or strLine.lstrip()[:15] == 'pdb.set_trace()':
            nLines.append( nLine)
        nLine += 1
    nLines.reverse()
    for nLine in nLines:
        vim.command( 'normal %dG' % nLine)
        vim.command( 'normal dd')
        if nLine < nCurrentLine:
            nCurrentLine -= 1
    vim.command( 'normal %dG' % nCurrentLine)
    # vim.command( 'map <C-F8> :py RemoveBreakpoints()<cr>')
EOF
"}}}
" }}}1

" Search for selected text, forwards or backwards."{{{
" æœç´¢é€‰ä¸­çš„æ–‡æœ¬
vnoremap <silent> * :<C-U>
  \let old_reg=getreg('"')<Bar>let old_regtype=getregtype('"')<CR>
  \gvy/<C-R><C-R>=substitute(
  \escape(@", '/\.*$^~['), '\_s\+', '\\_s\\+', 'g')<CR><CR>
  \gV:call setreg('"', old_reg, old_regtype)<CR>
vnoremap <silent> # :<C-U>
  \let old_reg=getreg('"')<Bar>let old_regtype=getregtype('"')<CR>
  \gvy?<C-R><C-R>=substitute(
  \escape(@", '?\.*$^~['), '\_s\+', '\\_s\\+', 'g')<CR><CR>
  \gV:call setreg('"', old_reg, old_regtype)<CR>
let @y='^i#include "A"j'
nmap ;f :source ~/workspace/latex/code/chapter_5/vam_info.vim<cr>
"}}}
"
" è®©gvimæ”¯æŒAlt+næ¥åˆ‡æ¢æ ‡ç­¾é¡µ"{{{
"
function! Tabmap_Initialize()
    for i in range(1, 9)
        exe "map <A-".i."> ".i."gt"
    endfor
    exe "map <A-0> 10gt"
endfunction
autocmd VimEnter * call Tabmap_Initialize()
"}}}
"
" ,=åˆ‡æ¢vimå­—ä½“çš„å¤§"{{{
"
function! Switch_Font()
    if &guifont == "Courier 10 Pitch 20"
        exec "set guifont=Courier\\ 10\\ Pitch\\ 12"
    else
        exec "set guifont=Courier\\ 10\\ Pitch\\ 20"
    endif
endfunction
nmap <leader>= :call Switch_Font()<cr>
"}}}
"
" }}}1
"
" æ‰‹åŠ¨è®¾ç½®çŠ¶æ€è¡Œ"{{{
"
"set statusline=%F%h%m%r%w%y%<\ %{&ff}\ %{Get_diff_mode()}\ %{getcwd()}%=\ %l\,%L\ %c%V\ %P%([%{Tlist_Get_Tagname_By_Line()}]%)
"set statusline=%F%h%m%r%w%y%<\ %{&ff}\ %{Get_diff_mode()}\ %{
            "\getcwd()}%=\ %l\,%L\ %c%V\ %P
set statusline=%{fugitive#statusline()}%F%h%m%r%w%y%<\ %{Get_diff_mode()}\ %=\ %l\,%L\ %c%V\ %P
set laststatus=2
fun! Get_diff_mode()
    " è¿”å›å½“å‰æ˜¯å¦å¤„äºæ¯”å¯¹çŠ¶æ€
    if &diff
        return "[Diff]"
    else
        return ""
    endif
endf"}}}
"
" F6æ¥æ‹·è´å½“å‰é€‰æ‹©å†…å®¹åˆ°+å‰ªè´´æ¿"{{{
"
"vnoremap <F6> "+y
"nnoremap <F6> vi'"+y"}}}
"
" ConqueTerm è®¾ç½®"{{{
"
let g:ConqueTerm_FastMode = 0
"let g:ConqueTerm_TERM = 'xterm'"}}}
"
" ç”¨diffæ¨¡å¼å¯¹æ¯”å½“å‰æ–‡ä»¶åœ¨æ‰“å¼€åè¿›è¡Œçš„æ‰€æœ‰ä¿®æ”¹"{{{
"
command! DiffOrig let s:old_ft=&ft | vert new | 
            \set bt=nofile |execute "set ft=".s:old_ft | r # 
            \| 0d_ | diffthis | wincmd p | diffthis
"}}}

"
" è®¾ç½®æ¯”è¾ƒæ¨¡å¼å‚ç›´çª—å£ã€å¡«å……ç©ºè¡Œã€æŠ˜å ä¸Šä¸‹2è¡Œ"{{{
" è®¾ç½®å¼ºåˆ¶åˆ·æ–°å¿«æ·é”® ,du
"
set diffopt=filler,vertical,context:2
nnoremap <silent> <leader>du :diffupdate<cr>"}}}

"
" è®¾ç½®neocomplcache "{{{
let g:neocomplcache_enable_at_startup=1  "}}}

"è®¾ç½®vimrepress"{{{
let VIMPRESS = [{'username':'bailiangcn',
                \'password':'bl1973',
                \'blog_url':'http://www.cnblogs.com/bailiang'
                \}]"}}}
                 
